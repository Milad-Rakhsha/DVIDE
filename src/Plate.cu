#include <algorithm>
#include <vector>
#include "include.cuh"
#include "Plate.cuh"
#include "System.cuh"

int Plate::addPlate(int j)
{
  setIdentifier(sys->bodies.size()+sys->beams.size()+j); // Indicates the number that the Plate was added
  setIndex(sys->p_h.size()); // Indicates the Plate's location in the position array

  // Push Beam's location to global library
  sys->indices_h.push_back(sys->p_h.size());

  // update p
  sys->p_h.push_back(p_n0.x);
  sys->p_h.push_back(p_n0.y);
  sys->p_h.push_back(p_n0.z);
  sys->p_h.push_back(p_dxi0.x);
  sys->p_h.push_back(p_dxi0.y);
  sys->p_h.push_back(p_dxi0.z);
  sys->p_h.push_back(p_deta0.x);
  sys->p_h.push_back(p_deta0.y);
  sys->p_h.push_back(p_deta0.z);
  sys->p_h.push_back(p_n1.x);
  sys->p_h.push_back(p_n1.y);
  sys->p_h.push_back(p_n1.z);
  sys->p_h.push_back(p_dxi1.x);
  sys->p_h.push_back(p_dxi1.y);
  sys->p_h.push_back(p_dxi1.z);
  sys->p_h.push_back(p_deta1.x);
  sys->p_h.push_back(p_deta1.y);
  sys->p_h.push_back(p_deta1.z);
  sys->p_h.push_back(p_n2.x);
  sys->p_h.push_back(p_n2.y);
  sys->p_h.push_back(p_n2.z);
  sys->p_h.push_back(p_dxi2.x);
  sys->p_h.push_back(p_dxi2.y);
  sys->p_h.push_back(p_dxi2.z);
  sys->p_h.push_back(p_deta2.x);
  sys->p_h.push_back(p_deta2.y);
  sys->p_h.push_back(p_deta2.z);
  sys->p_h.push_back(p_n3.x);
  sys->p_h.push_back(p_n3.y);
  sys->p_h.push_back(p_n3.z);
  sys->p_h.push_back(p_dxi3.x);
  sys->p_h.push_back(p_dxi3.y);
  sys->p_h.push_back(p_dxi3.z);
  sys->p_h.push_back(p_deta3.x);
  sys->p_h.push_back(p_deta3.y);
  sys->p_h.push_back(p_deta3.z);

  // update v
  sys->v_h.push_back(v_n0.x);
  sys->v_h.push_back(v_n0.y);
  sys->v_h.push_back(v_n0.z);
  sys->v_h.push_back(v_dxi0.x);
  sys->v_h.push_back(v_dxi0.y);
  sys->v_h.push_back(v_dxi0.z);
  sys->v_h.push_back(v_deta0.x);
  sys->v_h.push_back(v_deta0.y);
  sys->v_h.push_back(v_deta0.z);
  sys->v_h.push_back(v_n1.x);
  sys->v_h.push_back(v_n1.y);
  sys->v_h.push_back(v_n1.z);
  sys->v_h.push_back(v_dxi1.x);
  sys->v_h.push_back(v_dxi1.y);
  sys->v_h.push_back(v_dxi1.z);
  sys->v_h.push_back(v_deta1.x);
  sys->v_h.push_back(v_deta1.y);
  sys->v_h.push_back(v_deta1.z);
  sys->v_h.push_back(v_n2.x);
  sys->v_h.push_back(v_n2.y);
  sys->v_h.push_back(v_n2.z);
  sys->v_h.push_back(v_dxi2.x);
  sys->v_h.push_back(v_dxi2.y);
  sys->v_h.push_back(v_dxi2.z);
  sys->v_h.push_back(v_deta2.x);
  sys->v_h.push_back(v_deta2.y);
  sys->v_h.push_back(v_deta2.z);
  sys->v_h.push_back(v_n3.x);
  sys->v_h.push_back(v_n3.y);
  sys->v_h.push_back(v_n3.z);
  sys->v_h.push_back(v_dxi3.x);
  sys->v_h.push_back(v_dxi3.y);
  sys->v_h.push_back(v_dxi3.z);
  sys->v_h.push_back(v_deta3.x);
  sys->v_h.push_back(v_deta3.y);
  sys->v_h.push_back(v_deta3.z);

  // update a
  sys->a_h.push_back(a_n0.x);
  sys->a_h.push_back(a_n0.y);
  sys->a_h.push_back(a_n0.z);
  sys->a_h.push_back(a_dxi0.x);
  sys->a_h.push_back(a_dxi0.y);
  sys->a_h.push_back(a_dxi0.z);
  sys->a_h.push_back(a_deta0.x);
  sys->a_h.push_back(a_deta0.y);
  sys->a_h.push_back(a_deta0.z);
  sys->a_h.push_back(a_n1.x);
  sys->a_h.push_back(a_n1.y);
  sys->a_h.push_back(a_n1.z);
  sys->a_h.push_back(a_dxi1.x);
  sys->a_h.push_back(a_dxi1.y);
  sys->a_h.push_back(a_dxi1.z);
  sys->a_h.push_back(a_deta1.x);
  sys->a_h.push_back(a_deta1.y);
  sys->a_h.push_back(a_deta1.z);
  sys->a_h.push_back(a_n2.x);
  sys->a_h.push_back(a_n2.y);
  sys->a_h.push_back(a_n2.z);
  sys->a_h.push_back(a_dxi2.x);
  sys->a_h.push_back(a_dxi2.y);
  sys->a_h.push_back(a_dxi2.z);
  sys->a_h.push_back(a_deta2.x);
  sys->a_h.push_back(a_deta2.y);
  sys->a_h.push_back(a_deta2.z);
  sys->a_h.push_back(a_n3.x);
  sys->a_h.push_back(a_n3.y);
  sys->a_h.push_back(a_n3.z);
  sys->a_h.push_back(a_dxi3.x);
  sys->a_h.push_back(a_dxi3.y);
  sys->a_h.push_back(a_dxi3.z);
  sys->a_h.push_back(a_deta3.x);
  sys->a_h.push_back(a_deta3.y);
  sys->a_h.push_back(a_deta3.z);

  // update external force vector (gravity)
  double rho = getDensity();
  double3 f = rho*sys->gravity;
  double a = contactGeometry.x;
  double b = contactGeometry.y;
  double th = thickness;

  sys->f_h.push_back(f.x*th*(1.0/4.0));
  sys->f_h.push_back(f.y*th*(1.0/4.0));
  sys->f_h.push_back(f.z*th*(1.0/4.0));
  sys->f_h.push_back(a*f.x*th*(1.0/2.4E1));
  sys->f_h.push_back(a*f.y*th*(1.0/2.4E1));
  sys->f_h.push_back(a*f.z*th*(1.0/2.4E1));
  sys->f_h.push_back(b*f.x*th*(1.0/2.4E1));
  sys->f_h.push_back(b*f.y*th*(1.0/2.4E1));
  sys->f_h.push_back(b*f.z*th*(1.0/2.4E1));
  sys->f_h.push_back(f.x*th*(1.0/4.0));
  sys->f_h.push_back(f.y*th*(1.0/4.0));
  sys->f_h.push_back(f.z*th*(1.0/4.0));
  sys->f_h.push_back(a*f.x*th*(-1.0/2.4E1));
  sys->f_h.push_back(a*f.y*th*(-1.0/2.4E1));
  sys->f_h.push_back(a*f.z*th*(-1.0/2.4E1));
  sys->f_h.push_back(b*f.x*th*(1.0/2.4E1));
  sys->f_h.push_back(b*f.y*th*(1.0/2.4E1));
  sys->f_h.push_back(b*f.z*th*(1.0/2.4E1));
  sys->f_h.push_back(f.x*th*(1.0/4.0));
  sys->f_h.push_back(f.y*th*(1.0/4.0));
  sys->f_h.push_back(f.z*th*(1.0/4.0));
  sys->f_h.push_back(a*f.x*th*(-1.0/2.4E1));
  sys->f_h.push_back(a*f.y*th*(-1.0/2.4E1));
  sys->f_h.push_back(a*f.z*th*(-1.0/2.4E1));
  sys->f_h.push_back(b*f.x*th*(-1.0/2.4E1));
  sys->f_h.push_back(b*f.y*th*(-1.0/2.4E1));
  sys->f_h.push_back(b*f.z*th*(-1.0/2.4E1));
  sys->f_h.push_back(f.x*th*(1.0/4.0));
  sys->f_h.push_back(f.y*th*(1.0/4.0));
  sys->f_h.push_back(f.z*th*(1.0/4.0));
  sys->f_h.push_back(a*f.x*th*(1.0/2.4E1));
  sys->f_h.push_back(a*f.y*th*(1.0/2.4E1));
  sys->f_h.push_back(a*f.z*th*(1.0/2.4E1));
  sys->f_h.push_back(b*f.x*th*(-1.0/2.4E1));
  sys->f_h.push_back(b*f.y*th*(-1.0/2.4E1));
  sys->f_h.push_back(b*f.z*th*(-1.0/2.4E1));

  for(int i=0;i<36;i++) {
    sys->f_contact_h.push_back(0);
    sys->fApplied_h.push_back(0);
    sys->fElastic_h.push_back(0);
    sys->tmp_h.push_back(0);
    sys->k_h.push_back(0);
    sys->r_h.push_back(0);
    sys->strainDerivativePlate_h.push_back(make_double3(0,0,0));
    sys->curvatureDerivativePlate_h.push_back(make_double3(0,0,0));
  }

  sys->strainEnergyPlate_h.push_back(0);
  sys->strainPlate_h.push_back(make_double3(0,0,0));
  for(int k=0;k<sys->wt6.size()*sys->pt6.size();k++) sys->strainPlate0_h.push_back(make_double3(0,0,0));
  for(int k=0;k<sys->wt5.size()*sys->pt5.size();k++) sys->curvaturePlate0_h.push_back(make_double3(0,0,0));

  for(int i=0;i<12;i++) {
    sys->Sx_h.push_back(0);
    sys->Sxx_h.push_back(0);
    sys->Sy_h.push_back(0);
    sys->Syy_h.push_back(0);
  }

  // update the sys->mass matrix
  int offset = j*36+12*sys->beams.size()+3*sys->bodies.size();
  sys->massI_h.push_back(0+offset);
  sys->massJ_h.push_back(0+offset);
  sys->mass_h.push_back(1.12E2/(rho*th));
  sys->massI_h.push_back(0+offset);
  sys->massJ_h.push_back(3+offset);
  sys->mass_h.push_back(-5.52E2/(a*rho*th));
  sys->massI_h.push_back(0+offset);
  sys->massJ_h.push_back(6+offset);
  sys->mass_h.push_back(-5.52E2/(b*rho*th));
  sys->massI_h.push_back(0+offset);
  sys->massJ_h.push_back(9+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(0+offset);
  sys->massJ_h.push_back(12+offset);
  sys->mass_h.push_back(-3.12E2/(a*rho*th));
  sys->massI_h.push_back(0+offset);
  sys->massJ_h.push_back(15+offset);
  sys->mass_h.push_back(2.52E2/(b*rho*th));
  sys->massI_h.push_back(0+offset);
  sys->massJ_h.push_back(18+offset);
  sys->mass_h.push_back(1.2E1/(rho*th));
  sys->massI_h.push_back(0+offset);
  sys->massJ_h.push_back(21+offset);
  sys->mass_h.push_back(1.32E2/(a*rho*th));
  sys->massI_h.push_back(0+offset);
  sys->massJ_h.push_back(24+offset);
  sys->mass_h.push_back(1.32E2/(b*rho*th));
  sys->massI_h.push_back(0+offset);
  sys->massJ_h.push_back(27+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(0+offset);
  sys->massJ_h.push_back(30+offset);
  sys->mass_h.push_back(2.52E2/(a*rho*th));
  sys->massI_h.push_back(0+offset);
  sys->massJ_h.push_back(33+offset);
  sys->mass_h.push_back(-3.12E2/(b*rho*th));
  sys->massI_h.push_back(1+offset);
  sys->massJ_h.push_back(1+offset);
  sys->mass_h.push_back(1.12E2/(rho*th));
  sys->massI_h.push_back(1+offset);
  sys->massJ_h.push_back(4+offset);
  sys->mass_h.push_back(-5.52E2/(a*rho*th));
  sys->massI_h.push_back(1+offset);
  sys->massJ_h.push_back(7+offset);
  sys->mass_h.push_back(-5.52E2/(b*rho*th));
  sys->massI_h.push_back(1+offset);
  sys->massJ_h.push_back(10+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(1+offset);
  sys->massJ_h.push_back(13+offset);
  sys->mass_h.push_back(-3.12E2/(a*rho*th));
  sys->massI_h.push_back(1+offset);
  sys->massJ_h.push_back(16+offset);
  sys->mass_h.push_back(2.52E2/(b*rho*th));
  sys->massI_h.push_back(1+offset);
  sys->massJ_h.push_back(19+offset);
  sys->mass_h.push_back(1.2E1/(rho*th));
  sys->massI_h.push_back(1+offset);
  sys->massJ_h.push_back(22+offset);
  sys->mass_h.push_back(1.32E2/(a*rho*th));
  sys->massI_h.push_back(1+offset);
  sys->massJ_h.push_back(25+offset);
  sys->mass_h.push_back(1.32E2/(b*rho*th));
  sys->massI_h.push_back(1+offset);
  sys->massJ_h.push_back(28+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(1+offset);
  sys->massJ_h.push_back(31+offset);
  sys->mass_h.push_back(2.52E2/(a*rho*th));
  sys->massI_h.push_back(1+offset);
  sys->massJ_h.push_back(34+offset);
  sys->mass_h.push_back(-3.12E2/(b*rho*th));
  sys->massI_h.push_back(2+offset);
  sys->massJ_h.push_back(2+offset);
  sys->mass_h.push_back(1.12E2/(rho*th));
  sys->massI_h.push_back(2+offset);
  sys->massJ_h.push_back(5+offset);
  sys->mass_h.push_back(-5.52E2/(a*rho*th));
  sys->massI_h.push_back(2+offset);
  sys->massJ_h.push_back(8+offset);
  sys->mass_h.push_back(-5.52E2/(b*rho*th));
  sys->massI_h.push_back(2+offset);
  sys->massJ_h.push_back(11+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(2+offset);
  sys->massJ_h.push_back(14+offset);
  sys->mass_h.push_back(-3.12E2/(a*rho*th));
  sys->massI_h.push_back(2+offset);
  sys->massJ_h.push_back(17+offset);
  sys->mass_h.push_back(2.52E2/(b*rho*th));
  sys->massI_h.push_back(2+offset);
  sys->massJ_h.push_back(20+offset);
  sys->mass_h.push_back(1.2E1/(rho*th));
  sys->massI_h.push_back(2+offset);
  sys->massJ_h.push_back(23+offset);
  sys->mass_h.push_back(1.32E2/(a*rho*th));
  sys->massI_h.push_back(2+offset);
  sys->massJ_h.push_back(26+offset);
  sys->mass_h.push_back(1.32E2/(b*rho*th));
  sys->massI_h.push_back(2+offset);
  sys->massJ_h.push_back(29+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(2+offset);
  sys->massJ_h.push_back(32+offset);
  sys->mass_h.push_back(2.52E2/(a*rho*th));
  sys->massI_h.push_back(2+offset);
  sys->massJ_h.push_back(35+offset);
  sys->mass_h.push_back(-3.12E2/(b*rho*th));
  sys->massI_h.push_back(3+offset);
  sys->massJ_h.push_back(0+offset);
  sys->mass_h.push_back(-5.52E2/(a*rho*th));
  sys->massI_h.push_back(3+offset);
  sys->massJ_h.push_back(3+offset);
  sys->mass_h.push_back((1.0/(a*a)*4.944E3)/(rho*th));
  sys->massI_h.push_back(3+offset);
  sys->massJ_h.push_back(6+offset);
  sys->mass_h.push_back(1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(3+offset);
  sys->massJ_h.push_back(9+offset);
  sys->mass_h.push_back(3.12E2/(a*rho*th));
  sys->massI_h.push_back(3+offset);
  sys->massJ_h.push_back(12+offset);
  sys->mass_h.push_back((1.0/(a*a)*3.504E3)/(rho*th));
  sys->massI_h.push_back(3+offset);
  sys->massJ_h.push_back(15+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(3+offset);
  sys->massJ_h.push_back(18+offset);
  sys->mass_h.push_back(-1.32E2/(a*rho*th));
  sys->massI_h.push_back(3+offset);
  sys->massJ_h.push_back(21+offset);
  sys->mass_h.push_back((1.0/(a*a)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(3+offset);
  sys->massJ_h.push_back(24+offset);
  sys->mass_h.push_back(-6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(3+offset);
  sys->massJ_h.push_back(27+offset);
  sys->mass_h.push_back(2.52E2/(a*rho*th));
  sys->massI_h.push_back(3+offset);
  sys->massJ_h.push_back(30+offset);
  sys->mass_h.push_back((1.0/(a*a)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(3+offset);
  sys->massJ_h.push_back(33+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(4+offset);
  sys->massJ_h.push_back(1+offset);
  sys->mass_h.push_back(-5.52E2/(a*rho*th));
  sys->massI_h.push_back(4+offset);
  sys->massJ_h.push_back(4+offset);
  sys->mass_h.push_back((1.0/(a*a)*4.944E3)/(rho*th));
  sys->massI_h.push_back(4+offset);
  sys->massJ_h.push_back(7+offset);
  sys->mass_h.push_back(1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(4+offset);
  sys->massJ_h.push_back(10+offset);
  sys->mass_h.push_back(3.12E2/(a*rho*th));
  sys->massI_h.push_back(4+offset);
  sys->massJ_h.push_back(13+offset);
  sys->mass_h.push_back((1.0/(a*a)*3.504E3)/(rho*th));
  sys->massI_h.push_back(4+offset);
  sys->massJ_h.push_back(16+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(4+offset);
  sys->massJ_h.push_back(19+offset);
  sys->mass_h.push_back(-1.32E2/(a*rho*th));
  sys->massI_h.push_back(4+offset);
  sys->massJ_h.push_back(22+offset);
  sys->mass_h.push_back((1.0/(a*a)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(4+offset);
  sys->massJ_h.push_back(25+offset);
  sys->mass_h.push_back(-6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(4+offset);
  sys->massJ_h.push_back(28+offset);
  sys->mass_h.push_back(2.52E2/(a*rho*th));
  sys->massI_h.push_back(4+offset);
  sys->massJ_h.push_back(31+offset);
  sys->mass_h.push_back((1.0/(a*a)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(4+offset);
  sys->massJ_h.push_back(34+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(5+offset);
  sys->massJ_h.push_back(2+offset);
  sys->mass_h.push_back(-5.52E2/(a*rho*th));
  sys->massI_h.push_back(5+offset);
  sys->massJ_h.push_back(5+offset);
  sys->mass_h.push_back((1.0/(a*a)*4.944E3)/(rho*th));
  sys->massI_h.push_back(5+offset);
  sys->massJ_h.push_back(8+offset);
  sys->mass_h.push_back(1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(5+offset);
  sys->massJ_h.push_back(11+offset);
  sys->mass_h.push_back(3.12E2/(a*rho*th));
  sys->massI_h.push_back(5+offset);
  sys->massJ_h.push_back(14+offset);
  sys->mass_h.push_back((1.0/(a*a)*3.504E3)/(rho*th));
  sys->massI_h.push_back(5+offset);
  sys->massJ_h.push_back(17+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(5+offset);
  sys->massJ_h.push_back(20+offset);
  sys->mass_h.push_back(-1.32E2/(a*rho*th));
  sys->massI_h.push_back(5+offset);
  sys->massJ_h.push_back(23+offset);
  sys->mass_h.push_back((1.0/(a*a)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(5+offset);
  sys->massJ_h.push_back(26+offset);
  sys->mass_h.push_back(-6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(5+offset);
  sys->massJ_h.push_back(29+offset);
  sys->mass_h.push_back(2.52E2/(a*rho*th));
  sys->massI_h.push_back(5+offset);
  sys->massJ_h.push_back(32+offset);
  sys->mass_h.push_back((1.0/(a*a)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(5+offset);
  sys->massJ_h.push_back(35+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(6+offset);
  sys->massJ_h.push_back(0+offset);
  sys->mass_h.push_back(-5.52E2/(b*rho*th));
  sys->massI_h.push_back(6+offset);
  sys->massJ_h.push_back(3+offset);
  sys->mass_h.push_back(1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(6+offset);
  sys->massJ_h.push_back(6+offset);
  sys->mass_h.push_back((1.0/(b*b)*4.944E3)/(rho*th));
  sys->massI_h.push_back(6+offset);
  sys->massJ_h.push_back(9+offset);
  sys->mass_h.push_back(2.52E2/(b*rho*th));
  sys->massI_h.push_back(6+offset);
  sys->massJ_h.push_back(12+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(6+offset);
  sys->massJ_h.push_back(15+offset);
  sys->mass_h.push_back((1.0/(b*b)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(6+offset);
  sys->massJ_h.push_back(18+offset);
  sys->mass_h.push_back(-1.32E2/(b*rho*th));
  sys->massI_h.push_back(6+offset);
  sys->massJ_h.push_back(21+offset);
  sys->mass_h.push_back(-6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(6+offset);
  sys->massJ_h.push_back(24+offset);
  sys->mass_h.push_back((1.0/(b*b)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(6+offset);
  sys->massJ_h.push_back(27+offset);
  sys->mass_h.push_back(3.12E2/(b*rho*th));
  sys->massI_h.push_back(6+offset);
  sys->massJ_h.push_back(30+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(6+offset);
  sys->massJ_h.push_back(33+offset);
  sys->mass_h.push_back((1.0/(b*b)*3.504E3)/(rho*th));
  sys->massI_h.push_back(7+offset);
  sys->massJ_h.push_back(1+offset);
  sys->mass_h.push_back(-5.52E2/(b*rho*th));
  sys->massI_h.push_back(7+offset);
  sys->massJ_h.push_back(4+offset);
  sys->mass_h.push_back(1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(7+offset);
  sys->massJ_h.push_back(7+offset);
  sys->mass_h.push_back((1.0/(b*b)*4.944E3)/(rho*th));
  sys->massI_h.push_back(7+offset);
  sys->massJ_h.push_back(10+offset);
  sys->mass_h.push_back(2.52E2/(b*rho*th));
  sys->massI_h.push_back(7+offset);
  sys->massJ_h.push_back(13+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(7+offset);
  sys->massJ_h.push_back(16+offset);
  sys->mass_h.push_back((1.0/(b*b)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(7+offset);
  sys->massJ_h.push_back(19+offset);
  sys->mass_h.push_back(-1.32E2/(b*rho*th));
  sys->massI_h.push_back(7+offset);
  sys->massJ_h.push_back(22+offset);
  sys->mass_h.push_back(-6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(7+offset);
  sys->massJ_h.push_back(25+offset);
  sys->mass_h.push_back((1.0/(b*b)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(7+offset);
  sys->massJ_h.push_back(28+offset);
  sys->mass_h.push_back(3.12E2/(b*rho*th));
  sys->massI_h.push_back(7+offset);
  sys->massJ_h.push_back(31+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(7+offset);
  sys->massJ_h.push_back(34+offset);
  sys->mass_h.push_back((1.0/(b*b)*3.504E3)/(rho*th));
  sys->massI_h.push_back(8+offset);
  sys->massJ_h.push_back(2+offset);
  sys->mass_h.push_back(-5.52E2/(b*rho*th));
  sys->massI_h.push_back(8+offset);
  sys->massJ_h.push_back(5+offset);
  sys->mass_h.push_back(1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(8+offset);
  sys->massJ_h.push_back(8+offset);
  sys->mass_h.push_back((1.0/(b*b)*4.944E3)/(rho*th));
  sys->massI_h.push_back(8+offset);
  sys->massJ_h.push_back(11+offset);
  sys->mass_h.push_back(2.52E2/(b*rho*th));
  sys->massI_h.push_back(8+offset);
  sys->massJ_h.push_back(14+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(8+offset);
  sys->massJ_h.push_back(17+offset);
  sys->mass_h.push_back((1.0/(b*b)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(8+offset);
  sys->massJ_h.push_back(20+offset);
  sys->mass_h.push_back(-1.32E2/(b*rho*th));
  sys->massI_h.push_back(8+offset);
  sys->massJ_h.push_back(23+offset);
  sys->mass_h.push_back(-6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(8+offset);
  sys->massJ_h.push_back(26+offset);
  sys->mass_h.push_back((1.0/(b*b)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(8+offset);
  sys->massJ_h.push_back(29+offset);
  sys->mass_h.push_back(3.12E2/(b*rho*th));
  sys->massI_h.push_back(8+offset);
  sys->massJ_h.push_back(32+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(8+offset);
  sys->massJ_h.push_back(35+offset);
  sys->mass_h.push_back((1.0/(b*b)*3.504E3)/(rho*th));
  sys->massI_h.push_back(9+offset);
  sys->massJ_h.push_back(0+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(9+offset);
  sys->massJ_h.push_back(3+offset);
  sys->mass_h.push_back(3.12E2/(a*rho*th));
  sys->massI_h.push_back(9+offset);
  sys->massJ_h.push_back(6+offset);
  sys->mass_h.push_back(2.52E2/(b*rho*th));
  sys->massI_h.push_back(9+offset);
  sys->massJ_h.push_back(9+offset);
  sys->mass_h.push_back(1.12E2/(rho*th));
  sys->massI_h.push_back(9+offset);
  sys->massJ_h.push_back(12+offset);
  sys->mass_h.push_back(5.52E2/(a*rho*th));
  sys->massI_h.push_back(9+offset);
  sys->massJ_h.push_back(15+offset);
  sys->mass_h.push_back(-5.52E2/(b*rho*th));
  sys->massI_h.push_back(9+offset);
  sys->massJ_h.push_back(18+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(9+offset);
  sys->massJ_h.push_back(21+offset);
  sys->mass_h.push_back(-2.52E2/(a*rho*th));
  sys->massI_h.push_back(9+offset);
  sys->massJ_h.push_back(24+offset);
  sys->mass_h.push_back(-3.12E2/(b*rho*th));
  sys->massI_h.push_back(9+offset);
  sys->massJ_h.push_back(27+offset);
  sys->mass_h.push_back(1.2E1/(rho*th));
  sys->massI_h.push_back(9+offset);
  sys->massJ_h.push_back(30+offset);
  sys->mass_h.push_back(-1.32E2/(a*rho*th));
  sys->massI_h.push_back(9+offset);
  sys->massJ_h.push_back(33+offset);
  sys->mass_h.push_back(1.32E2/(b*rho*th));
  sys->massI_h.push_back(10+offset);
  sys->massJ_h.push_back(1+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(10+offset);
  sys->massJ_h.push_back(4+offset);
  sys->mass_h.push_back(3.12E2/(a*rho*th));
  sys->massI_h.push_back(10+offset);
  sys->massJ_h.push_back(7+offset);
  sys->mass_h.push_back(2.52E2/(b*rho*th));
  sys->massI_h.push_back(10+offset);
  sys->massJ_h.push_back(10+offset);
  sys->mass_h.push_back(1.12E2/(rho*th));
  sys->massI_h.push_back(10+offset);
  sys->massJ_h.push_back(13+offset);
  sys->mass_h.push_back(5.52E2/(a*rho*th));
  sys->massI_h.push_back(10+offset);
  sys->massJ_h.push_back(16+offset);
  sys->mass_h.push_back(-5.52E2/(b*rho*th));
  sys->massI_h.push_back(10+offset);
  sys->massJ_h.push_back(19+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(10+offset);
  sys->massJ_h.push_back(22+offset);
  sys->mass_h.push_back(-2.52E2/(a*rho*th));
  sys->massI_h.push_back(10+offset);
  sys->massJ_h.push_back(25+offset);
  sys->mass_h.push_back(-3.12E2/(b*rho*th));
  sys->massI_h.push_back(10+offset);
  sys->massJ_h.push_back(28+offset);
  sys->mass_h.push_back(1.2E1/(rho*th));
  sys->massI_h.push_back(10+offset);
  sys->massJ_h.push_back(31+offset);
  sys->mass_h.push_back(-1.32E2/(a*rho*th));
  sys->massI_h.push_back(10+offset);
  sys->massJ_h.push_back(34+offset);
  sys->mass_h.push_back(1.32E2/(b*rho*th));
  sys->massI_h.push_back(11+offset);
  sys->massJ_h.push_back(2+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(11+offset);
  sys->massJ_h.push_back(5+offset);
  sys->mass_h.push_back(3.12E2/(a*rho*th));
  sys->massI_h.push_back(11+offset);
  sys->massJ_h.push_back(8+offset);
  sys->mass_h.push_back(2.52E2/(b*rho*th));
  sys->massI_h.push_back(11+offset);
  sys->massJ_h.push_back(11+offset);
  sys->mass_h.push_back(1.12E2/(rho*th));
  sys->massI_h.push_back(11+offset);
  sys->massJ_h.push_back(14+offset);
  sys->mass_h.push_back(5.52E2/(a*rho*th));
  sys->massI_h.push_back(11+offset);
  sys->massJ_h.push_back(17+offset);
  sys->mass_h.push_back(-5.52E2/(b*rho*th));
  sys->massI_h.push_back(11+offset);
  sys->massJ_h.push_back(20+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(11+offset);
  sys->massJ_h.push_back(23+offset);
  sys->mass_h.push_back(-2.52E2/(a*rho*th));
  sys->massI_h.push_back(11+offset);
  sys->massJ_h.push_back(26+offset);
  sys->mass_h.push_back(-3.12E2/(b*rho*th));
  sys->massI_h.push_back(11+offset);
  sys->massJ_h.push_back(29+offset);
  sys->mass_h.push_back(1.2E1/(rho*th));
  sys->massI_h.push_back(11+offset);
  sys->massJ_h.push_back(32+offset);
  sys->mass_h.push_back(-1.32E2/(a*rho*th));
  sys->massI_h.push_back(11+offset);
  sys->massJ_h.push_back(35+offset);
  sys->mass_h.push_back(1.32E2/(b*rho*th));
  sys->massI_h.push_back(12+offset);
  sys->massJ_h.push_back(0+offset);
  sys->mass_h.push_back(-3.12E2/(a*rho*th));
  sys->massI_h.push_back(12+offset);
  sys->massJ_h.push_back(3+offset);
  sys->mass_h.push_back((1.0/(a*a)*3.504E3)/(rho*th));
  sys->massI_h.push_back(12+offset);
  sys->massJ_h.push_back(6+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(12+offset);
  sys->massJ_h.push_back(9+offset);
  sys->mass_h.push_back(5.52E2/(a*rho*th));
  sys->massI_h.push_back(12+offset);
  sys->massJ_h.push_back(12+offset);
  sys->mass_h.push_back((1.0/(a*a)*4.944E3)/(rho*th));
  sys->massI_h.push_back(12+offset);
  sys->massJ_h.push_back(15+offset);
  sys->mass_h.push_back(-1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(12+offset);
  sys->massJ_h.push_back(18+offset);
  sys->mass_h.push_back(-2.52E2/(a*rho*th));
  sys->massI_h.push_back(12+offset);
  sys->massJ_h.push_back(21+offset);
  sys->mass_h.push_back((1.0/(a*a)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(12+offset);
  sys->massJ_h.push_back(24+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(12+offset);
  sys->massJ_h.push_back(27+offset);
  sys->mass_h.push_back(1.32E2/(a*rho*th));
  sys->massI_h.push_back(12+offset);
  sys->massJ_h.push_back(30+offset);
  sys->mass_h.push_back((1.0/(a*a)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(12+offset);
  sys->massJ_h.push_back(33+offset);
  sys->mass_h.push_back(6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(13+offset);
  sys->massJ_h.push_back(1+offset);
  sys->mass_h.push_back(-3.12E2/(a*rho*th));
  sys->massI_h.push_back(13+offset);
  sys->massJ_h.push_back(4+offset);
  sys->mass_h.push_back((1.0/(a*a)*3.504E3)/(rho*th));
  sys->massI_h.push_back(13+offset);
  sys->massJ_h.push_back(7+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(13+offset);
  sys->massJ_h.push_back(10+offset);
  sys->mass_h.push_back(5.52E2/(a*rho*th));
  sys->massI_h.push_back(13+offset);
  sys->massJ_h.push_back(13+offset);
  sys->mass_h.push_back((1.0/(a*a)*4.944E3)/(rho*th));
  sys->massI_h.push_back(13+offset);
  sys->massJ_h.push_back(16+offset);
  sys->mass_h.push_back(-1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(13+offset);
  sys->massJ_h.push_back(19+offset);
  sys->mass_h.push_back(-2.52E2/(a*rho*th));
  sys->massI_h.push_back(13+offset);
  sys->massJ_h.push_back(22+offset);
  sys->mass_h.push_back((1.0/(a*a)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(13+offset);
  sys->massJ_h.push_back(25+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(13+offset);
  sys->massJ_h.push_back(28+offset);
  sys->mass_h.push_back(1.32E2/(a*rho*th));
  sys->massI_h.push_back(13+offset);
  sys->massJ_h.push_back(31+offset);
  sys->mass_h.push_back((1.0/(a*a)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(13+offset);
  sys->massJ_h.push_back(34+offset);
  sys->mass_h.push_back(6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(14+offset);
  sys->massJ_h.push_back(2+offset);
  sys->mass_h.push_back(-3.12E2/(a*rho*th));
  sys->massI_h.push_back(14+offset);
  sys->massJ_h.push_back(5+offset);
  sys->mass_h.push_back((1.0/(a*a)*3.504E3)/(rho*th));
  sys->massI_h.push_back(14+offset);
  sys->massJ_h.push_back(8+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(14+offset);
  sys->massJ_h.push_back(11+offset);
  sys->mass_h.push_back(5.52E2/(a*rho*th));
  sys->massI_h.push_back(14+offset);
  sys->massJ_h.push_back(14+offset);
  sys->mass_h.push_back((1.0/(a*a)*4.944E3)/(rho*th));
  sys->massI_h.push_back(14+offset);
  sys->massJ_h.push_back(17+offset);
  sys->mass_h.push_back(-1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(14+offset);
  sys->massJ_h.push_back(20+offset);
  sys->mass_h.push_back(-2.52E2/(a*rho*th));
  sys->massI_h.push_back(14+offset);
  sys->massJ_h.push_back(23+offset);
  sys->mass_h.push_back((1.0/(a*a)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(14+offset);
  sys->massJ_h.push_back(26+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(14+offset);
  sys->massJ_h.push_back(29+offset);
  sys->mass_h.push_back(1.32E2/(a*rho*th));
  sys->massI_h.push_back(14+offset);
  sys->massJ_h.push_back(32+offset);
  sys->mass_h.push_back((1.0/(a*a)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(14+offset);
  sys->massJ_h.push_back(35+offset);
  sys->mass_h.push_back(6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(15+offset);
  sys->massJ_h.push_back(0+offset);
  sys->mass_h.push_back(2.52E2/(b*rho*th));
  sys->massI_h.push_back(15+offset);
  sys->massJ_h.push_back(3+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(15+offset);
  sys->massJ_h.push_back(6+offset);
  sys->mass_h.push_back((1.0/(b*b)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(15+offset);
  sys->massJ_h.push_back(9+offset);
  sys->mass_h.push_back(-5.52E2/(b*rho*th));
  sys->massI_h.push_back(15+offset);
  sys->massJ_h.push_back(12+offset);
  sys->mass_h.push_back(-1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(15+offset);
  sys->massJ_h.push_back(15+offset);
  sys->mass_h.push_back((1.0/(b*b)*4.944E3)/(rho*th));
  sys->massI_h.push_back(15+offset);
  sys->massJ_h.push_back(18+offset);
  sys->mass_h.push_back(3.12E2/(b*rho*th));
  sys->massI_h.push_back(15+offset);
  sys->massJ_h.push_back(21+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(15+offset);
  sys->massJ_h.push_back(24+offset);
  sys->mass_h.push_back((1.0/(b*b)*3.504E3)/(rho*th));
  sys->massI_h.push_back(15+offset);
  sys->massJ_h.push_back(27+offset);
  sys->mass_h.push_back(-1.32E2/(b*rho*th));
  sys->massI_h.push_back(15+offset);
  sys->massJ_h.push_back(30+offset);
  sys->mass_h.push_back(6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(15+offset);
  sys->massJ_h.push_back(33+offset);
  sys->mass_h.push_back((1.0/(b*b)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(16+offset);
  sys->massJ_h.push_back(1+offset);
  sys->mass_h.push_back(2.52E2/(b*rho*th));
  sys->massI_h.push_back(16+offset);
  sys->massJ_h.push_back(4+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(16+offset);
  sys->massJ_h.push_back(7+offset);
  sys->mass_h.push_back((1.0/(b*b)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(16+offset);
  sys->massJ_h.push_back(10+offset);
  sys->mass_h.push_back(-5.52E2/(b*rho*th));
  sys->massI_h.push_back(16+offset);
  sys->massJ_h.push_back(13+offset);
  sys->mass_h.push_back(-1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(16+offset);
  sys->massJ_h.push_back(16+offset);
  sys->mass_h.push_back((1.0/(b*b)*4.944E3)/(rho*th));
  sys->massI_h.push_back(16+offset);
  sys->massJ_h.push_back(19+offset);
  sys->mass_h.push_back(3.12E2/(b*rho*th));
  sys->massI_h.push_back(16+offset);
  sys->massJ_h.push_back(22+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(16+offset);
  sys->massJ_h.push_back(25+offset);
  sys->mass_h.push_back((1.0/(b*b)*3.504E3)/(rho*th));
  sys->massI_h.push_back(16+offset);
  sys->massJ_h.push_back(28+offset);
  sys->mass_h.push_back(-1.32E2/(b*rho*th));
  sys->massI_h.push_back(16+offset);
  sys->massJ_h.push_back(31+offset);
  sys->mass_h.push_back(6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(16+offset);
  sys->massJ_h.push_back(34+offset);
  sys->mass_h.push_back((1.0/(b*b)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(17+offset);
  sys->massJ_h.push_back(2+offset);
  sys->mass_h.push_back(2.52E2/(b*rho*th));
  sys->massI_h.push_back(17+offset);
  sys->massJ_h.push_back(5+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(17+offset);
  sys->massJ_h.push_back(8+offset);
  sys->mass_h.push_back((1.0/(b*b)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(17+offset);
  sys->massJ_h.push_back(11+offset);
  sys->mass_h.push_back(-5.52E2/(b*rho*th));
  sys->massI_h.push_back(17+offset);
  sys->massJ_h.push_back(14+offset);
  sys->mass_h.push_back(-1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(17+offset);
  sys->massJ_h.push_back(17+offset);
  sys->mass_h.push_back((1.0/(b*b)*4.944E3)/(rho*th));
  sys->massI_h.push_back(17+offset);
  sys->massJ_h.push_back(20+offset);
  sys->mass_h.push_back(3.12E2/(b*rho*th));
  sys->massI_h.push_back(17+offset);
  sys->massJ_h.push_back(23+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(17+offset);
  sys->massJ_h.push_back(26+offset);
  sys->mass_h.push_back((1.0/(b*b)*3.504E3)/(rho*th));
  sys->massI_h.push_back(17+offset);
  sys->massJ_h.push_back(29+offset);
  sys->mass_h.push_back(-1.32E2/(b*rho*th));
  sys->massI_h.push_back(17+offset);
  sys->massJ_h.push_back(32+offset);
  sys->mass_h.push_back(6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(17+offset);
  sys->massJ_h.push_back(35+offset);
  sys->mass_h.push_back((1.0/(b*b)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(18+offset);
  sys->massJ_h.push_back(0+offset);
  sys->mass_h.push_back(1.2E1/(rho*th));
  sys->massI_h.push_back(18+offset);
  sys->massJ_h.push_back(3+offset);
  sys->mass_h.push_back(-1.32E2/(a*rho*th));
  sys->massI_h.push_back(18+offset);
  sys->massJ_h.push_back(6+offset);
  sys->mass_h.push_back(-1.32E2/(b*rho*th));
  sys->massI_h.push_back(18+offset);
  sys->massJ_h.push_back(9+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(18+offset);
  sys->massJ_h.push_back(12+offset);
  sys->mass_h.push_back(-2.52E2/(a*rho*th));
  sys->massI_h.push_back(18+offset);
  sys->massJ_h.push_back(15+offset);
  sys->mass_h.push_back(3.12E2/(b*rho*th));
  sys->massI_h.push_back(18+offset);
  sys->massJ_h.push_back(18+offset);
  sys->mass_h.push_back(1.12E2/(rho*th));
  sys->massI_h.push_back(18+offset);
  sys->massJ_h.push_back(21+offset);
  sys->mass_h.push_back(5.52E2/(a*rho*th));
  sys->massI_h.push_back(18+offset);
  sys->massJ_h.push_back(24+offset);
  sys->mass_h.push_back(5.52E2/(b*rho*th));
  sys->massI_h.push_back(18+offset);
  sys->massJ_h.push_back(27+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(18+offset);
  sys->massJ_h.push_back(30+offset);
  sys->mass_h.push_back(3.12E2/(a*rho*th));
  sys->massI_h.push_back(18+offset);
  sys->massJ_h.push_back(33+offset);
  sys->mass_h.push_back(-2.52E2/(b*rho*th));
  sys->massI_h.push_back(19+offset);
  sys->massJ_h.push_back(1+offset);
  sys->mass_h.push_back(1.2E1/(rho*th));
  sys->massI_h.push_back(19+offset);
  sys->massJ_h.push_back(4+offset);
  sys->mass_h.push_back(-1.32E2/(a*rho*th));
  sys->massI_h.push_back(19+offset);
  sys->massJ_h.push_back(7+offset);
  sys->mass_h.push_back(-1.32E2/(b*rho*th));
  sys->massI_h.push_back(19+offset);
  sys->massJ_h.push_back(10+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(19+offset);
  sys->massJ_h.push_back(13+offset);
  sys->mass_h.push_back(-2.52E2/(a*rho*th));
  sys->massI_h.push_back(19+offset);
  sys->massJ_h.push_back(16+offset);
  sys->mass_h.push_back(3.12E2/(b*rho*th));
  sys->massI_h.push_back(19+offset);
  sys->massJ_h.push_back(19+offset);
  sys->mass_h.push_back(1.12E2/(rho*th));
  sys->massI_h.push_back(19+offset);
  sys->massJ_h.push_back(22+offset);
  sys->mass_h.push_back(5.52E2/(a*rho*th));
  sys->massI_h.push_back(19+offset);
  sys->massJ_h.push_back(25+offset);
  sys->mass_h.push_back(5.52E2/(b*rho*th));
  sys->massI_h.push_back(19+offset);
  sys->massJ_h.push_back(28+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(19+offset);
  sys->massJ_h.push_back(31+offset);
  sys->mass_h.push_back(3.12E2/(a*rho*th));
  sys->massI_h.push_back(19+offset);
  sys->massJ_h.push_back(34+offset);
  sys->mass_h.push_back(-2.52E2/(b*rho*th));
  sys->massI_h.push_back(20+offset);
  sys->massJ_h.push_back(2+offset);
  sys->mass_h.push_back(1.2E1/(rho*th));
  sys->massI_h.push_back(20+offset);
  sys->massJ_h.push_back(5+offset);
  sys->mass_h.push_back(-1.32E2/(a*rho*th));
  sys->massI_h.push_back(20+offset);
  sys->massJ_h.push_back(8+offset);
  sys->mass_h.push_back(-1.32E2/(b*rho*th));
  sys->massI_h.push_back(20+offset);
  sys->massJ_h.push_back(11+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(20+offset);
  sys->massJ_h.push_back(14+offset);
  sys->mass_h.push_back(-2.52E2/(a*rho*th));
  sys->massI_h.push_back(20+offset);
  sys->massJ_h.push_back(17+offset);
  sys->mass_h.push_back(3.12E2/(b*rho*th));
  sys->massI_h.push_back(20+offset);
  sys->massJ_h.push_back(20+offset);
  sys->mass_h.push_back(1.12E2/(rho*th));
  sys->massI_h.push_back(20+offset);
  sys->massJ_h.push_back(23+offset);
  sys->mass_h.push_back(5.52E2/(a*rho*th));
  sys->massI_h.push_back(20+offset);
  sys->massJ_h.push_back(26+offset);
  sys->mass_h.push_back(5.52E2/(b*rho*th));
  sys->massI_h.push_back(20+offset);
  sys->massJ_h.push_back(29+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(20+offset);
  sys->massJ_h.push_back(32+offset);
  sys->mass_h.push_back(3.12E2/(a*rho*th));
  sys->massI_h.push_back(20+offset);
  sys->massJ_h.push_back(35+offset);
  sys->mass_h.push_back(-2.52E2/(b*rho*th));
  sys->massI_h.push_back(21+offset);
  sys->massJ_h.push_back(0+offset);
  sys->mass_h.push_back(1.32E2/(a*rho*th));
  sys->massI_h.push_back(21+offset);
  sys->massJ_h.push_back(3+offset);
  sys->mass_h.push_back((1.0/(a*a)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(21+offset);
  sys->massJ_h.push_back(6+offset);
  sys->mass_h.push_back(-6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(21+offset);
  sys->massJ_h.push_back(9+offset);
  sys->mass_h.push_back(-2.52E2/(a*rho*th));
  sys->massI_h.push_back(21+offset);
  sys->massJ_h.push_back(12+offset);
  sys->mass_h.push_back((1.0/(a*a)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(21+offset);
  sys->massJ_h.push_back(15+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(21+offset);
  sys->massJ_h.push_back(18+offset);
  sys->mass_h.push_back(5.52E2/(a*rho*th));
  sys->massI_h.push_back(21+offset);
  sys->massJ_h.push_back(21+offset);
  sys->mass_h.push_back((1.0/(a*a)*4.944E3)/(rho*th));
  sys->massI_h.push_back(21+offset);
  sys->massJ_h.push_back(24+offset);
  sys->mass_h.push_back(1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(21+offset);
  sys->massJ_h.push_back(27+offset);
  sys->mass_h.push_back(-3.12E2/(a*rho*th));
  sys->massI_h.push_back(21+offset);
  sys->massJ_h.push_back(30+offset);
  sys->mass_h.push_back((1.0/(a*a)*3.504E3)/(rho*th));
  sys->massI_h.push_back(21+offset);
  sys->massJ_h.push_back(33+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(22+offset);
  sys->massJ_h.push_back(1+offset);
  sys->mass_h.push_back(1.32E2/(a*rho*th));
  sys->massI_h.push_back(22+offset);
  sys->massJ_h.push_back(4+offset);
  sys->mass_h.push_back((1.0/(a*a)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(22+offset);
  sys->massJ_h.push_back(7+offset);
  sys->mass_h.push_back(-6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(22+offset);
  sys->massJ_h.push_back(10+offset);
  sys->mass_h.push_back(-2.52E2/(a*rho*th));
  sys->massI_h.push_back(22+offset);
  sys->massJ_h.push_back(13+offset);
  sys->mass_h.push_back((1.0/(a*a)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(22+offset);
  sys->massJ_h.push_back(16+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(22+offset);
  sys->massJ_h.push_back(19+offset);
  sys->mass_h.push_back(5.52E2/(a*rho*th));
  sys->massI_h.push_back(22+offset);
  sys->massJ_h.push_back(22+offset);
  sys->mass_h.push_back((1.0/(a*a)*4.944E3)/(rho*th));
  sys->massI_h.push_back(22+offset);
  sys->massJ_h.push_back(25+offset);
  sys->mass_h.push_back(1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(22+offset);
  sys->massJ_h.push_back(28+offset);
  sys->mass_h.push_back(-3.12E2/(a*rho*th));
  sys->massI_h.push_back(22+offset);
  sys->massJ_h.push_back(31+offset);
  sys->mass_h.push_back((1.0/(a*a)*3.504E3)/(rho*th));
  sys->massI_h.push_back(22+offset);
  sys->massJ_h.push_back(34+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(23+offset);
  sys->massJ_h.push_back(2+offset);
  sys->mass_h.push_back(1.32E2/(a*rho*th));
  sys->massI_h.push_back(23+offset);
  sys->massJ_h.push_back(5+offset);
  sys->mass_h.push_back((1.0/(a*a)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(23+offset);
  sys->massJ_h.push_back(8+offset);
  sys->mass_h.push_back(-6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(23+offset);
  sys->massJ_h.push_back(11+offset);
  sys->mass_h.push_back(-2.52E2/(a*rho*th));
  sys->massI_h.push_back(23+offset);
  sys->massJ_h.push_back(14+offset);
  sys->mass_h.push_back((1.0/(a*a)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(23+offset);
  sys->massJ_h.push_back(17+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(23+offset);
  sys->massJ_h.push_back(20+offset);
  sys->mass_h.push_back(5.52E2/(a*rho*th));
  sys->massI_h.push_back(23+offset);
  sys->massJ_h.push_back(23+offset);
  sys->mass_h.push_back((1.0/(a*a)*4.944E3)/(rho*th));
  sys->massI_h.push_back(23+offset);
  sys->massJ_h.push_back(26+offset);
  sys->mass_h.push_back(1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(23+offset);
  sys->massJ_h.push_back(29+offset);
  sys->mass_h.push_back(-3.12E2/(a*rho*th));
  sys->massI_h.push_back(23+offset);
  sys->massJ_h.push_back(32+offset);
  sys->mass_h.push_back((1.0/(a*a)*3.504E3)/(rho*th));
  sys->massI_h.push_back(23+offset);
  sys->massJ_h.push_back(35+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(24+offset);
  sys->massJ_h.push_back(0+offset);
  sys->mass_h.push_back(1.32E2/(b*rho*th));
  sys->massI_h.push_back(24+offset);
  sys->massJ_h.push_back(3+offset);
  sys->mass_h.push_back(-6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(24+offset);
  sys->massJ_h.push_back(6+offset);
  sys->mass_h.push_back((1.0/(b*b)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(24+offset);
  sys->massJ_h.push_back(9+offset);
  sys->mass_h.push_back(-3.12E2/(b*rho*th));
  sys->massI_h.push_back(24+offset);
  sys->massJ_h.push_back(12+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(24+offset);
  sys->massJ_h.push_back(15+offset);
  sys->mass_h.push_back((1.0/(b*b)*3.504E3)/(rho*th));
  sys->massI_h.push_back(24+offset);
  sys->massJ_h.push_back(18+offset);
  sys->mass_h.push_back(5.52E2/(b*rho*th));
  sys->massI_h.push_back(24+offset);
  sys->massJ_h.push_back(21+offset);
  sys->mass_h.push_back(1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(24+offset);
  sys->massJ_h.push_back(24+offset);
  sys->mass_h.push_back((1.0/(b*b)*4.944E3)/(rho*th));
  sys->massI_h.push_back(24+offset);
  sys->massJ_h.push_back(27+offset);
  sys->mass_h.push_back(-2.52E2/(b*rho*th));
  sys->massI_h.push_back(24+offset);
  sys->massJ_h.push_back(30+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(24+offset);
  sys->massJ_h.push_back(33+offset);
  sys->mass_h.push_back((1.0/(b*b)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(25+offset);
  sys->massJ_h.push_back(1+offset);
  sys->mass_h.push_back(1.32E2/(b*rho*th));
  sys->massI_h.push_back(25+offset);
  sys->massJ_h.push_back(4+offset);
  sys->mass_h.push_back(-6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(25+offset);
  sys->massJ_h.push_back(7+offset);
  sys->mass_h.push_back((1.0/(b*b)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(25+offset);
  sys->massJ_h.push_back(10+offset);
  sys->mass_h.push_back(-3.12E2/(b*rho*th));
  sys->massI_h.push_back(25+offset);
  sys->massJ_h.push_back(13+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(25+offset);
  sys->massJ_h.push_back(16+offset);
  sys->mass_h.push_back((1.0/(b*b)*3.504E3)/(rho*th));
  sys->massI_h.push_back(25+offset);
  sys->massJ_h.push_back(19+offset);
  sys->mass_h.push_back(5.52E2/(b*rho*th));
  sys->massI_h.push_back(25+offset);
  sys->massJ_h.push_back(22+offset);
  sys->mass_h.push_back(1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(25+offset);
  sys->massJ_h.push_back(25+offset);
  sys->mass_h.push_back((1.0/(b*b)*4.944E3)/(rho*th));
  sys->massI_h.push_back(25+offset);
  sys->massJ_h.push_back(28+offset);
  sys->mass_h.push_back(-2.52E2/(b*rho*th));
  sys->massI_h.push_back(25+offset);
  sys->massJ_h.push_back(31+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(25+offset);
  sys->massJ_h.push_back(34+offset);
  sys->mass_h.push_back((1.0/(b*b)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(26+offset);
  sys->massJ_h.push_back(2+offset);
  sys->mass_h.push_back(1.32E2/(b*rho*th));
  sys->massI_h.push_back(26+offset);
  sys->massJ_h.push_back(5+offset);
  sys->mass_h.push_back(-6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(26+offset);
  sys->massJ_h.push_back(8+offset);
  sys->mass_h.push_back((1.0/(b*b)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(26+offset);
  sys->massJ_h.push_back(11+offset);
  sys->mass_h.push_back(-3.12E2/(b*rho*th));
  sys->massI_h.push_back(26+offset);
  sys->massJ_h.push_back(14+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(26+offset);
  sys->massJ_h.push_back(17+offset);
  sys->mass_h.push_back((1.0/(b*b)*3.504E3)/(rho*th));
  sys->massI_h.push_back(26+offset);
  sys->massJ_h.push_back(20+offset);
  sys->mass_h.push_back(5.52E2/(b*rho*th));
  sys->massI_h.push_back(26+offset);
  sys->massJ_h.push_back(23+offset);
  sys->mass_h.push_back(1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(26+offset);
  sys->massJ_h.push_back(26+offset);
  sys->mass_h.push_back((1.0/(b*b)*4.944E3)/(rho*th));
  sys->massI_h.push_back(26+offset);
  sys->massJ_h.push_back(29+offset);
  sys->mass_h.push_back(-2.52E2/(b*rho*th));
  sys->massI_h.push_back(26+offset);
  sys->massJ_h.push_back(32+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(26+offset);
  sys->massJ_h.push_back(35+offset);
  sys->mass_h.push_back((1.0/(b*b)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(27+offset);
  sys->massJ_h.push_back(0+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(27+offset);
  sys->massJ_h.push_back(3+offset);
  sys->mass_h.push_back(2.52E2/(a*rho*th));
  sys->massI_h.push_back(27+offset);
  sys->massJ_h.push_back(6+offset);
  sys->mass_h.push_back(3.12E2/(b*rho*th));
  sys->massI_h.push_back(27+offset);
  sys->massJ_h.push_back(9+offset);
  sys->mass_h.push_back(1.2E1/(rho*th));
  sys->massI_h.push_back(27+offset);
  sys->massJ_h.push_back(12+offset);
  sys->mass_h.push_back(1.32E2/(a*rho*th));
  sys->massI_h.push_back(27+offset);
  sys->massJ_h.push_back(15+offset);
  sys->mass_h.push_back(-1.32E2/(b*rho*th));
  sys->massI_h.push_back(27+offset);
  sys->massJ_h.push_back(18+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(27+offset);
  sys->massJ_h.push_back(21+offset);
  sys->mass_h.push_back(-3.12E2/(a*rho*th));
  sys->massI_h.push_back(27+offset);
  sys->massJ_h.push_back(24+offset);
  sys->mass_h.push_back(-2.52E2/(b*rho*th));
  sys->massI_h.push_back(27+offset);
  sys->massJ_h.push_back(27+offset);
  sys->mass_h.push_back(1.12E2/(rho*th));
  sys->massI_h.push_back(27+offset);
  sys->massJ_h.push_back(30+offset);
  sys->mass_h.push_back(-5.52E2/(a*rho*th));
  sys->massI_h.push_back(27+offset);
  sys->massJ_h.push_back(33+offset);
  sys->mass_h.push_back(5.52E2/(b*rho*th));
  sys->massI_h.push_back(28+offset);
  sys->massJ_h.push_back(1+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(28+offset);
  sys->massJ_h.push_back(4+offset);
  sys->mass_h.push_back(2.52E2/(a*rho*th));
  sys->massI_h.push_back(28+offset);
  sys->massJ_h.push_back(7+offset);
  sys->mass_h.push_back(3.12E2/(b*rho*th));
  sys->massI_h.push_back(28+offset);
  sys->massJ_h.push_back(10+offset);
  sys->mass_h.push_back(1.2E1/(rho*th));
  sys->massI_h.push_back(28+offset);
  sys->massJ_h.push_back(13+offset);
  sys->mass_h.push_back(1.32E2/(a*rho*th));
  sys->massI_h.push_back(28+offset);
  sys->massJ_h.push_back(16+offset);
  sys->mass_h.push_back(-1.32E2/(b*rho*th));
  sys->massI_h.push_back(28+offset);
  sys->massJ_h.push_back(19+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(28+offset);
  sys->massJ_h.push_back(22+offset);
  sys->mass_h.push_back(-3.12E2/(a*rho*th));
  sys->massI_h.push_back(28+offset);
  sys->massJ_h.push_back(25+offset);
  sys->mass_h.push_back(-2.52E2/(b*rho*th));
  sys->massI_h.push_back(28+offset);
  sys->massJ_h.push_back(28+offset);
  sys->mass_h.push_back(1.12E2/(rho*th));
  sys->massI_h.push_back(28+offset);
  sys->massJ_h.push_back(31+offset);
  sys->mass_h.push_back(-5.52E2/(a*rho*th));
  sys->massI_h.push_back(28+offset);
  sys->massJ_h.push_back(34+offset);
  sys->mass_h.push_back(5.52E2/(b*rho*th));
  sys->massI_h.push_back(29+offset);
  sys->massJ_h.push_back(2+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(29+offset);
  sys->massJ_h.push_back(5+offset);
  sys->mass_h.push_back(2.52E2/(a*rho*th));
  sys->massI_h.push_back(29+offset);
  sys->massJ_h.push_back(8+offset);
  sys->mass_h.push_back(3.12E2/(b*rho*th));
  sys->massI_h.push_back(29+offset);
  sys->massJ_h.push_back(11+offset);
  sys->mass_h.push_back(1.2E1/(rho*th));
  sys->massI_h.push_back(29+offset);
  sys->massJ_h.push_back(14+offset);
  sys->mass_h.push_back(1.32E2/(a*rho*th));
  sys->massI_h.push_back(29+offset);
  sys->massJ_h.push_back(17+offset);
  sys->mass_h.push_back(-1.32E2/(b*rho*th));
  sys->massI_h.push_back(29+offset);
  sys->massJ_h.push_back(20+offset);
  sys->mass_h.push_back(-4.0E1/(rho*th));
  sys->massI_h.push_back(29+offset);
  sys->massJ_h.push_back(23+offset);
  sys->mass_h.push_back(-3.12E2/(a*rho*th));
  sys->massI_h.push_back(29+offset);
  sys->massJ_h.push_back(26+offset);
  sys->mass_h.push_back(-2.52E2/(b*rho*th));
  sys->massI_h.push_back(29+offset);
  sys->massJ_h.push_back(29+offset);
  sys->mass_h.push_back(1.12E2/(rho*th));
  sys->massI_h.push_back(29+offset);
  sys->massJ_h.push_back(32+offset);
  sys->mass_h.push_back(-5.52E2/(a*rho*th));
  sys->massI_h.push_back(29+offset);
  sys->massJ_h.push_back(35+offset);
  sys->mass_h.push_back(5.52E2/(b*rho*th));
  sys->massI_h.push_back(30+offset);
  sys->massJ_h.push_back(0+offset);
  sys->mass_h.push_back(2.52E2/(a*rho*th));
  sys->massI_h.push_back(30+offset);
  sys->massJ_h.push_back(3+offset);
  sys->mass_h.push_back((1.0/(a*a)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(30+offset);
  sys->massJ_h.push_back(6+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(30+offset);
  sys->massJ_h.push_back(9+offset);
  sys->mass_h.push_back(-1.32E2/(a*rho*th));
  sys->massI_h.push_back(30+offset);
  sys->massJ_h.push_back(12+offset);
  sys->mass_h.push_back((1.0/(a*a)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(30+offset);
  sys->massJ_h.push_back(15+offset);
  sys->mass_h.push_back(6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(30+offset);
  sys->massJ_h.push_back(18+offset);
  sys->mass_h.push_back(3.12E2/(a*rho*th));
  sys->massI_h.push_back(30+offset);
  sys->massJ_h.push_back(21+offset);
  sys->mass_h.push_back((1.0/(a*a)*3.504E3)/(rho*th));
  sys->massI_h.push_back(30+offset);
  sys->massJ_h.push_back(24+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(30+offset);
  sys->massJ_h.push_back(27+offset);
  sys->mass_h.push_back(-5.52E2/(a*rho*th));
  sys->massI_h.push_back(30+offset);
  sys->massJ_h.push_back(30+offset);
  sys->mass_h.push_back((1.0/(a*a)*4.944E3)/(rho*th));
  sys->massI_h.push_back(30+offset);
  sys->massJ_h.push_back(33+offset);
  sys->mass_h.push_back(-1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(31+offset);
  sys->massJ_h.push_back(1+offset);
  sys->mass_h.push_back(2.52E2/(a*rho*th));
  sys->massI_h.push_back(31+offset);
  sys->massJ_h.push_back(4+offset);
  sys->mass_h.push_back((1.0/(a*a)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(31+offset);
  sys->massJ_h.push_back(7+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(31+offset);
  sys->massJ_h.push_back(10+offset);
  sys->mass_h.push_back(-1.32E2/(a*rho*th));
  sys->massI_h.push_back(31+offset);
  sys->massJ_h.push_back(13+offset);
  sys->mass_h.push_back((1.0/(a*a)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(31+offset);
  sys->massJ_h.push_back(16+offset);
  sys->mass_h.push_back(6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(31+offset);
  sys->massJ_h.push_back(19+offset);
  sys->mass_h.push_back(3.12E2/(a*rho*th));
  sys->massI_h.push_back(31+offset);
  sys->massJ_h.push_back(22+offset);
  sys->mass_h.push_back((1.0/(a*a)*3.504E3)/(rho*th));
  sys->massI_h.push_back(31+offset);
  sys->massJ_h.push_back(25+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(31+offset);
  sys->massJ_h.push_back(28+offset);
  sys->mass_h.push_back(-5.52E2/(a*rho*th));
  sys->massI_h.push_back(31+offset);
  sys->massJ_h.push_back(31+offset);
  sys->mass_h.push_back((1.0/(a*a)*4.944E3)/(rho*th));
  sys->massI_h.push_back(31+offset);
  sys->massJ_h.push_back(34+offset);
  sys->mass_h.push_back(-1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(32+offset);
  sys->massJ_h.push_back(2+offset);
  sys->mass_h.push_back(2.52E2/(a*rho*th));
  sys->massI_h.push_back(32+offset);
  sys->massJ_h.push_back(5+offset);
  sys->mass_h.push_back((1.0/(a*a)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(32+offset);
  sys->massJ_h.push_back(8+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(32+offset);
  sys->massJ_h.push_back(11+offset);
  sys->mass_h.push_back(-1.32E2/(a*rho*th));
  sys->massI_h.push_back(32+offset);
  sys->massJ_h.push_back(14+offset);
  sys->mass_h.push_back((1.0/(a*a)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(32+offset);
  sys->massJ_h.push_back(17+offset);
  sys->mass_h.push_back(6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(32+offset);
  sys->massJ_h.push_back(20+offset);
  sys->mass_h.push_back(3.12E2/(a*rho*th));
  sys->massI_h.push_back(32+offset);
  sys->massJ_h.push_back(23+offset);
  sys->mass_h.push_back((1.0/(a*a)*3.504E3)/(rho*th));
  sys->massI_h.push_back(32+offset);
  sys->massJ_h.push_back(26+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(32+offset);
  sys->massJ_h.push_back(29+offset);
  sys->mass_h.push_back(-5.52E2/(a*rho*th));
  sys->massI_h.push_back(32+offset);
  sys->massJ_h.push_back(32+offset);
  sys->mass_h.push_back((1.0/(a*a)*4.944E3)/(rho*th));
  sys->massI_h.push_back(32+offset);
  sys->massJ_h.push_back(35+offset);
  sys->mass_h.push_back(-1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(33+offset);
  sys->massJ_h.push_back(0+offset);
  sys->mass_h.push_back(-3.12E2/(b*rho*th));
  sys->massI_h.push_back(33+offset);
  sys->massJ_h.push_back(3+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(33+offset);
  sys->massJ_h.push_back(6+offset);
  sys->mass_h.push_back((1.0/(b*b)*3.504E3)/(rho*th));
  sys->massI_h.push_back(33+offset);
  sys->massJ_h.push_back(9+offset);
  sys->mass_h.push_back(1.32E2/(b*rho*th));
  sys->massI_h.push_back(33+offset);
  sys->massJ_h.push_back(12+offset);
  sys->mass_h.push_back(6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(33+offset);
  sys->massJ_h.push_back(15+offset);
  sys->mass_h.push_back((1.0/(b*b)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(33+offset);
  sys->massJ_h.push_back(18+offset);
  sys->mass_h.push_back(-2.52E2/(b*rho*th));
  sys->massI_h.push_back(33+offset);
  sys->massJ_h.push_back(21+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(33+offset);
  sys->massJ_h.push_back(24+offset);
  sys->mass_h.push_back((1.0/(b*b)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(33+offset);
  sys->massJ_h.push_back(27+offset);
  sys->mass_h.push_back(5.52E2/(b*rho*th));
  sys->massI_h.push_back(33+offset);
  sys->massJ_h.push_back(30+offset);
  sys->mass_h.push_back(-1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(33+offset);
  sys->massJ_h.push_back(33+offset);
  sys->mass_h.push_back((1.0/(b*b)*4.944E3)/(rho*th));
  sys->massI_h.push_back(34+offset);
  sys->massJ_h.push_back(1+offset);
  sys->mass_h.push_back(-3.12E2/(b*rho*th));
  sys->massI_h.push_back(34+offset);
  sys->massJ_h.push_back(4+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(34+offset);
  sys->massJ_h.push_back(7+offset);
  sys->mass_h.push_back((1.0/(b*b)*3.504E3)/(rho*th));
  sys->massI_h.push_back(34+offset);
  sys->massJ_h.push_back(10+offset);
  sys->mass_h.push_back(1.32E2/(b*rho*th));
  sys->massI_h.push_back(34+offset);
  sys->massJ_h.push_back(13+offset);
  sys->mass_h.push_back(6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(34+offset);
  sys->massJ_h.push_back(16+offset);
  sys->mass_h.push_back((1.0/(b*b)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(34+offset);
  sys->massJ_h.push_back(19+offset);
  sys->mass_h.push_back(-2.52E2/(b*rho*th));
  sys->massI_h.push_back(34+offset);
  sys->massJ_h.push_back(22+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(34+offset);
  sys->massJ_h.push_back(25+offset);
  sys->mass_h.push_back((1.0/(b*b)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(34+offset);
  sys->massJ_h.push_back(28+offset);
  sys->mass_h.push_back(5.52E2/(b*rho*th));
  sys->massI_h.push_back(34+offset);
  sys->massJ_h.push_back(31+offset);
  sys->mass_h.push_back(-1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(34+offset);
  sys->massJ_h.push_back(34+offset);
  sys->mass_h.push_back((1.0/(b*b)*4.944E3)/(rho*th));
  sys->massI_h.push_back(35+offset);
  sys->massJ_h.push_back(2+offset);
  sys->mass_h.push_back(-3.12E2/(b*rho*th));
  sys->massI_h.push_back(35+offset);
  sys->massJ_h.push_back(5+offset);
  sys->mass_h.push_back(1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(35+offset);
  sys->massJ_h.push_back(8+offset);
  sys->mass_h.push_back((1.0/(b*b)*3.504E3)/(rho*th));
  sys->massI_h.push_back(35+offset);
  sys->massJ_h.push_back(11+offset);
  sys->mass_h.push_back(1.32E2/(b*rho*th));
  sys->massI_h.push_back(35+offset);
  sys->massJ_h.push_back(14+offset);
  sys->mass_h.push_back(6.84E2/(a*b*rho*th));
  sys->massI_h.push_back(35+offset);
  sys->massJ_h.push_back(17+offset);
  sys->mass_h.push_back((1.0/(b*b)*-1.704E3)/(rho*th));
  sys->massI_h.push_back(35+offset);
  sys->massJ_h.push_back(20+offset);
  sys->mass_h.push_back(-2.52E2/(b*rho*th));
  sys->massI_h.push_back(35+offset);
  sys->massJ_h.push_back(23+offset);
  sys->mass_h.push_back(-1.044E3/(a*b*rho*th));
  sys->massI_h.push_back(35+offset);
  sys->massJ_h.push_back(26+offset);
  sys->mass_h.push_back((1.0/(b*b)*-2.424E3)/(rho*th));
  sys->massI_h.push_back(35+offset);
  sys->massJ_h.push_back(29+offset);
  sys->mass_h.push_back(5.52E2/(b*rho*th));
  sys->massI_h.push_back(35+offset);
  sys->massJ_h.push_back(32+offset);
  sys->mass_h.push_back(-1.404E3/(a*b*rho*th));
  sys->massI_h.push_back(35+offset);
  sys->massJ_h.push_back(35+offset);
  sys->mass_h.push_back((1.0/(b*b)*4.944E3)/(rho*th));

  sys->contactGeometry_h.push_back(contactGeometry);
  sys->materialsPlate_h.push_back(make_double4(density,elasticModulus,nu,thickness));

  for(int i=0;i<contactGeometry.z;i++) {
    for(int j=0;j<contactGeometry.z;j++) {
      sys->collisionGeometry_h.push_back(make_double3(0.5*thickness,0,0));
      sys->collisionMap_h.push_back(make_int4(identifier,i,j,collisionFamily));
    }
  }

  return 0;
}

double3 Plate::transformNodalToCartesian(double xi, double eta)
{
  double a = contactGeometry.x;
  double b = contactGeometry.y;
  double3 pos;
  pos.x = -eta*sys->p_h[18+index]*xi*(eta*-3.0-xi*3.0+(eta*eta)*2.0+(xi*xi)*2.0+1.0)-sys->p_h[9+index]*xi*(eta-1.0)*(eta+xi*3.0-(eta*eta)*2.0-(xi*xi)*2.0)-eta*sys->p_h[27+index]*(xi-1.0)*(eta*3.0+xi-(eta*eta)*2.0-(xi*xi)*2.0)+sys->p_h[0+index]*(eta-1.0)*(xi-1.0)*(eta+xi-(eta*eta)*2.0-(xi*xi)*2.0+1.0)+b*eta*sys->p_h[15+index]*xi*pow(eta-1.0,2.0)+b*(eta*eta)*sys->p_h[24+index]*xi*(eta-1.0)+a*eta*sys->p_h[21+index]*(xi*xi)*(xi-1.0)+a*eta*sys->p_h[30+index]*xi*pow(xi-1.0,2.0)-b*eta*sys->p_h[6+index]*pow(eta-1.0,2.0)*(xi-1.0)-b*(eta*eta)*sys->p_h[33+index]*(eta-1.0)*(xi-1.0)-a*sys->p_h[3+index]*xi*(eta-1.0)*pow(xi-1.0,2.0)-a*sys->p_h[12+index]*(xi*xi)*(eta-1.0)*(xi-1.0);
  pos.y = -eta*sys->p_h[19+index]*xi*(eta*-3.0-xi*3.0+(eta*eta)*2.0+(xi*xi)*2.0+1.0)-sys->p_h[10+index]*xi*(eta-1.0)*(eta+xi*3.0-(eta*eta)*2.0-(xi*xi)*2.0)-eta*sys->p_h[28+index]*(xi-1.0)*(eta*3.0+xi-(eta*eta)*2.0-(xi*xi)*2.0)+sys->p_h[1+index]*(eta-1.0)*(xi-1.0)*(eta+xi-(eta*eta)*2.0-(xi*xi)*2.0+1.0)+b*eta*sys->p_h[16+index]*xi*pow(eta-1.0,2.0)+b*(eta*eta)*sys->p_h[25+index]*xi*(eta-1.0)+a*eta*sys->p_h[22+index]*(xi*xi)*(xi-1.0)+a*eta*sys->p_h[31+index]*xi*pow(xi-1.0,2.0)-b*eta*sys->p_h[7+index]*pow(eta-1.0,2.0)*(xi-1.0)-b*(eta*eta)*sys->p_h[34+index]*(eta-1.0)*(xi-1.0)-a*sys->p_h[4+index]*xi*(eta-1.0)*pow(xi-1.0,2.0)-a*sys->p_h[13+index]*(xi*xi)*(eta-1.0)*(xi-1.0);
  pos.z = -eta*sys->p_h[20+index]*xi*(eta*-3.0-xi*3.0+(eta*eta)*2.0+(xi*xi)*2.0+1.0)-sys->p_h[11+index]*xi*(eta-1.0)*(eta+xi*3.0-(eta*eta)*2.0-(xi*xi)*2.0)-eta*sys->p_h[29+index]*(xi-1.0)*(eta*3.0+xi-(eta*eta)*2.0-(xi*xi)*2.0)+sys->p_h[2+index]*(eta-1.0)*(xi-1.0)*(eta+xi-(eta*eta)*2.0-(xi*xi)*2.0+1.0)+b*eta*sys->p_h[17+index]*xi*pow(eta-1.0,2.0)+b*(eta*eta)*sys->p_h[26+index]*xi*(eta-1.0)+a*eta*sys->p_h[23+index]*(xi*xi)*(xi-1.0)+a*eta*sys->p_h[32+index]*xi*pow(xi-1.0,2.0)-b*eta*sys->p_h[8+index]*pow(eta-1.0,2.0)*(xi-1.0)-b*(eta*eta)*sys->p_h[35+index]*(eta-1.0)*(xi-1.0)-a*sys->p_h[5+index]*xi*(eta-1.0)*pow(xi-1.0,2.0)-a*sys->p_h[14+index]*(xi*xi)*(eta-1.0)*(xi-1.0);

  return pos;
}
